{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,0BAQMC,EAAO,CACTC,KAAMC,SAASC,cAAc,gBAC7BC,iBAAkBF,SAASC,cAAc,YAC3CE,SAAUH,SAASI,iBAAiB,cACpCC,MAAOL,SAASC,cAAc,cAG1BK,EAAkB,IAAI,EAAAV,EAAAW,iBAGxBC,EAAU,IAAIC,EAAAC,GAAJ,CAAmB,cA+CjC,SAASC,EAAWC,GAChB,IACIC,EAD6ED,EAAzEE,aAAyEF,EAA3DG,cAA2DH,EAA5CI,KAA4CJ,EAAtCK,MAAsCL,EAA/BM,MAA+BN,EAAxBO,SAAwBP,EAAdQ,UA2BnE,OAxBAP,EAASD,EAAKS,KAAI,SAAAC,G,IAAGR,EAAYQ,EAAZR,aAAcC,EAAaO,EAAbP,cAAeC,EAAIM,EAAJN,KAAMC,EAAKK,EAALL,MAAOC,EAAKI,EAALJ,MAAOC,EAAQG,EAARH,SAAUC,EAASE,EAATF,UAC5E,MAAO,YACDG,OADaR,EAAc,+DACLQ,OAAtBT,EAAa,WAIbS,OAJsBP,EAAK,2GAQ3BO,OAJAN,EAAM,kFAQLM,OAJDL,EAAM,uFAQNK,OAJCJ,EAAS,wFAIAI,OAAVH,EAAU,0C,IAGVI,KAAK,IAEf1B,EAAKI,iBAAiBuB,mBAAmB,YAAaZ,GACvCL,EAAQkB,S,CAG3B,SAASC,EAAQC,GACgB,IAAzBtB,EAAgBuB,KACpBpB,EAAAqB,GAASC,OAAOC,QAAQ,oBAAmCT,OAAfK,EAAKK,UAAU,aAChDL,EAAKhB,KAAKsB,OAAS5B,EAAgB6B,UAC5CC,EAASC,QAAQvC,EAAKO,OACxBI,EAAAqB,GAASC,OAAOO,QAAQ,+DAExBC,QAAQC,IAAIZ,EAAKhB,K,CAQrB,SAAS6B,EAAQC,GACbH,QAAQC,IAAIE,GACdjC,EAAAqB,GAASC,OAAOY,QACd,2E,CA7FJ7C,EAAKC,KAAK6C,MAAMC,QAAU,OAC1B/C,EAAKC,KAAK6C,MAAME,eAAiB,SACjChD,EAAKC,KAAK6C,MAAMG,QAAU,OAC1BjD,EAAKC,KAAK6C,MAAMI,gBAAkB,OAGlClD,EAAKI,iBAAiB0C,MAAMC,QAAU,OACtC/C,EAAKI,iBAAiB0C,MAAMK,SAAW,OACvCnD,EAAKI,iBAAiB0C,MAAMM,IAAM,OAClCpD,EAAKI,iBAAiB0C,MAAMC,QAAU,OACtC/C,EAAKI,iBAAiB0C,MAAME,eAAiB,gBAC7ChD,EAAKI,iBAAiB0C,MAAMG,QAAU,OAKtCjD,EAAKC,KAAKoD,iBAAiB,UAG3B,SAAsBC,GAKlB,GAHAA,EAAMC,iBACN/C,EAAgBgD,MAAQF,EAAMG,cAAcC,SAASC,YAAYC,MAAMC,QAElErD,EAAgBgD,MAEjB,YADA7C,EAAAqB,GAASC,OAAOO,QAAQ,0CAK5B,OADAhC,EAAgBsD,YACTtD,EACFuD,cACFC,MAAK,SAAAlC,GAGA,OAFFQ,EAASC,QAAQvC,EAAKO,OACpBsB,EAAQC,GACDA,EAAKhB,I,IAEfkD,KAAKnD,GAAYoD,MAAMtB,GAASuB,SAAQ,WACzClE,EAAKC,KAAKkE,O,OA4DlB,IAIQ7B,EAAW,IAAI8B,sBAIvB,SAAgBC,GACZ5B,QAAQC,IAAI2B,GACZA,EAAQC,SAAQ,SAAAC,GACZ9B,QAAQC,IAAI,uBAAwB6B,EAAMC,gBACtCD,EAAMC,iBACE,EACRhE,EACKuD,cACAC,MAAK,SAAAlC,GAGF,OAFAQ,EAASC,QAAQvC,EAAKO,OACtBsB,EAAQC,GACDA,EAAKhB,I,IAEfkD,KAAKnD,GAAYoD,MAAMtB,GAASuB,SAAQ,W,OAAMlE,EAAKC,KAAKkE,O,UArBzD,CACZM,KAAM,KACNC,WAAY,S","sources":["src/infinityscroll.js"],"sourcesContent":["import { ImageApiService } from \"./api-sourse\";\n\nimport Notiflix from 'notiflix';\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\n\n\nconst refs = {\n    form: document.querySelector(\".search-form\"),\n    galleryContainer: document.querySelector(\".gallery\"),\n  infoItem: document.querySelectorAll(\".info-item\"),\n  guard: document.querySelector('.js-guard'),\n}\n\nconst imageApiService = new ImageApiService();\n\n\nlet gallery = new SimpleLightbox('.gallery a');\n\n\nrefs.form.style.display = \"flex\";\nrefs.form.style.justifyContent = \"center\";\nrefs.form.style.padding = \"20px\";\nrefs.form.style.backgroundColor = \"blue\";\n\n\nrefs.galleryContainer.style.display = \"flex\";\nrefs.galleryContainer.style.flexWrap = \"wrap\";\nrefs.galleryContainer.style.gap = \"30px\";\nrefs.galleryContainer.style.display = \"flex\";\nrefs.galleryContainer.style.justifyContent = \"space-between\";\nrefs.galleryContainer.style.padding = \"20px\";\n\n\n\n\nrefs.form.addEventListener('submit', onFormSubmit);\n\n\nfunction onFormSubmit(event) {\n    \n    event.preventDefault();\n    imageApiService.query = event.currentTarget.elements.searchQuery.value.trim();\n\n    if (!imageApiService.query) {\n        Notiflix.Notify.warning(\"Please, enter something and try again!\");\n        return\n    }\n    \n    imageApiService.resetPage();\n    return imageApiService\n        .fetchImages()\n      .then(data => {\n          observer.observe(refs.guard);\n            message(data);\n            return data.hits\n        })\n        .then(makeMarkup).catch(onError).finally(() => {\n        refs.form.reset();\n    });\n    clearGalleryContainer();\n    \n}\n\nfunction makeMarkup(hits) {\n    const { webformatURL, largeImageURL, tags, likes, views, comments, downloads } = hits;\n    let markup = \"\";\n\n    markup = hits.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n        return `<a href=\"${largeImageURL}\" class=\"image-link\"><div class=\"photo-card\">\n  <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n  <div class=\"info\">\n    <p class=\"info-item\">\n      <b>Likes:</b>\n      <span>${likes}<span>\n    </p>\n    <p class=\"info-item\">\n      <b>Views:</b>\n      <span>${views}</span>\n    </p>\n    <p class=\"info-item\">\n      <b>Comments:</b>\n      <span> ${comments}</span>\n    </p>\n    <p class=\"info-item\">\n      <b>Downloads: </b>\n      <span>${downloads}</span>\n    </p>\n  </div>\n</div></a>`}).join('');\n\n    refs.galleryContainer.insertAdjacentHTML(\"beforeend\", markup);\n    return markup, gallery.refresh();\n}\n\nfunction message(data) {\n    if (imageApiService.page === 2) {\n    Notiflix.Notify.success(`Hooray! We found ${data.totalHits} images.`); \n    } else if (data.hits.length < imageApiService.perPage) {\n      observer.observe(refs.guard);\n    Notiflix.Notify.warning(\"We're sorry, but you've reached the end of search results.\");\n    } \n    console.log(data.hits);\n  }\n\n\nfunction clearGalleryContainer() {\n    refs.galleryContainer.innerHTML = \"\";\n}\n\nfunction onError(error) {\n    console.log(error);\n  Notiflix.Notify.failure(\n    'Sorry, there are no images matching your search query. Please try again.'\n  );\n  \n}\n\nconst details = {\n    root: null,\n    rootMargin: '300px',\n  };\n  const observer = new IntersectionObserver(onload, details);\n\nlet page = 1;\n\nfunction onload(entries) {\n    console.log(entries);\n    entries.forEach(entry => {\n        console.log('entry.isIntersecting', entry.isIntersecting);\n        if (entry.isIntersecting) {\n            page += 1;\n            imageApiService\n                .fetchImages()\n                .then(data => {\n                    observer.observe(refs.guard);\n                    message(data);\n                    return data.hits\n                })\n                .then(makeMarkup).catch(onError).finally(() => refs.form.reset())\n        }})\n       \n    }\n  \n   \n\n"],"names":["$6eqiI","parcelRequire","$97db1b2f146c86e3$var$refs","form","document","querySelector","galleryContainer","infoItem","querySelectorAll","guard","$97db1b2f146c86e3$var$imageApiService","ImageApiService","$97db1b2f146c86e3$var$gallery","$parcel$interopDefault","$5IjG7","$97db1b2f146c86e3$var$makeMarkup","hits","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","map","param","concat","join","insertAdjacentHTML","refresh","$97db1b2f146c86e3$var$message","data","page","$6JpON","Notify","success","totalHits","length","perPage","$97db1b2f146c86e3$var$observer","observe","warning","console","log","$97db1b2f146c86e3$var$onError","error","failure","style","display","justifyContent","padding","backgroundColor","flexWrap","gap","addEventListener","event","preventDefault","query","currentTarget","elements","searchQuery","value","trim","resetPage","fetchImages","then","catch","finally","reset","IntersectionObserver","entries","forEach","entry","isIntersecting","root","rootMargin"],"version":3,"file":"infinity-scroll.72df359e.js.map"}